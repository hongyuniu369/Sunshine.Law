@{
    Layout = "~/Views/Shared/_LayoutH5.cshtml";
    ViewBag.Title = "我要咨询-阳光问法-河北新闻网";
    ViewBag.EasyuiVersion = "1.3.2";
    ViewBag.locale = "zh_CN";
    ViewBag.theme = "gray";
    ViewBag.Keywords = "阳光问法,河北法律,河北法律平台";
}
@section head{

    <!--加载共通CSS-->
    <link href="~/Content/css/base.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/law/css/base.css" rel="stylesheet" type="text/css" />
    <!--[if IE]><link href="~/Content/css/hack/ie.css" rel="stylesheet" type="text/css" /><![endif]-->

    <!--加载960CSS框架-->
    <link href="~/Content/css/960/fluid/reset.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/css/960/fluid/text.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/css/960/fluid/grid.css" rel="stylesheet" type="text/css" />
    <!--[if IE 6]><link href="~/Content/css/960/fluid/ie6.css" rel="stylesheet" type="text/css" /><![endif]-->
    <!--[if IE 7]><link href="~/Content/css/960/fluid/ie.css"  rel="stylesheet" type="text/css" /><![endif]-->

    <!--加载主题CSS-->
    <link href="~/Content/themes/@ViewBag.theme/style.css" rel="stylesheet" type="text/css" />

    <!--加载按钮CSS-->
    <link href="~/Content/css/btns/css3btn.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/css/btns/sexybuttons.css" rel="stylesheet" type="text/css" />

    <!--加载组件CSS-->
    <link href="~/Content/js/jquery-plugin/showloading/showLoading.css" rel="stylesheet" type="text/css" />

    <!--加载样式修正CSS-->
    <link href="~/Content/css/hack/fix.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/law/css/zx.css" rel="stylesheet" type="text/css" />

    <link rel="stylesheet" href="~/Content/law/h5/assets/css/amazeui.min.css" />
    <link rel="stylesheet" href="~/Content/law/h5/assets/css/app.css" />

    <!--加载jQuery-->
    <script src="~/Content/js/jquery/jquery-1.8.1.min.js" type="text/javascript"></script>
    <!--加载脚本库-->
    @Scripts.Render("~/Content/js/library")
    <!--加载easyui加载器-->
    <script type="text/javascript" src="~/Content/js/jquery-easyui-@ViewBag.EasyuiVersion/easyloader.js?locale=@ViewBag.locale&theme=@ViewBag.theme"></script>
    <style>
    body{ margin:0 auto;}
    .zxcon {
    border-width: 0;
    padding-top: 0px;padding-left: 0px;
    width: auto;
}
.am-navbar-nav li {
    list-style: outside none none;
    text-align: center;
}    </style>
}
@section scripts{
    <script src="/Content/law/h5/js/wyzx.js"></script>
    <script type="text/javascript">
        var easyLoaded = function(){
            //设置联动Address
            setAddress(viewModel.pageData.form.Address(),'Address');
            setMsgClass(viewModel.pageData.form.MsgClass(),'Address');
        };

        using(['validatebox','combobox'], easyLoaded);
        using('/Content/js/jquery-easyui-1.3.2/jquery.easyui.validator.extend.js');
        var viewModel = function(data){ 
            var self = this;
            com.viewModel.edit.apply(self,arguments);
            this.dsIsOrNot = [{value:'true', text:'是'},{value:'false', text:'否'}];
        } 
        var data = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model));
        viewModel=new viewModel(data)
        ko.bindingViewModel(viewModel, document.getElementById('zxcon'));

        $(document).ready(function(){
        });
    </script>
}

<div data-am-widget="list_news" class="am-list-news am-list-news-default am-no-layout">
    <!--列表标题-->
    <div class="am-list-news-hd list-news-hd am-cf">
        <h2>温馨提示</h2>
    </div>
    <div class="am-list-news-bd">
        <ul class="am-list">
            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
                <div class="am-u-sm-11 am-list-main">
                    <h3 class="am-list-item-hd"><a href="javascript:void(0);" target="_top">欢迎使用河北新闻网法律咨询平台</a></h3>
                    <div class="am-list-item-text">
                        请详细填写以下内容，您的个人信息，本网会严加保密，敬请放心。(<span style="color: #ff0000">*</span>号为必填项)
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<div class="zxcon container_12" id="zxcon" data-bind="inputwidth:0.9">
    <div class="grid_3 lbl">案件标题：</div>
    <div class="grid_9 val">
        <input type="text" data-bind="value:pageData.form.MsgTitle ,readOnly:readonly" class="captial z-txt  easyui-validatebox" data-options="required:true,validType:['length[6,64]']" />
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">案件内容：</div>
    <div class="grid_9 val">
        <textarea style="height: 90px; width: 90%" class="z-txt  easyui-validatebox" data-bind="value:pageData.form.MsgContent ,readOnly:readonly" data-options="required:true,validType:['length[10,1000]']"></textarea>
        <br />
        <span>* 问题越详细，回答越精确。此项目将对所有人公开显示，请勿填写当事人姓名等隐私内容[10-500字]</span>
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">所在地区： </div>
    <div class="grid_9 val">
        <select class="z-txt" id="Province" name="Province" style="width: 60px;"></select>
        <select class="z-txt" id="City" name="City" style="width: 65px;"></select>
        <select class="z-txt" id="District" name="District" style="width: 70px;"></select>
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">是否公开：</div>
    <div class="grid_9 val">
        <input type="text" data-bind="datasource:dsIsOrNot, comboboxValue: pageData.form.IsOpen ,comboboxReadOnly: readonly" class="z-txt easyui-combobox" data-options="required:true,panelHeight:'auto'" />
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">联系电话：</div>
    <div class="grid_9 val">
        <input type="text" data-bind="value:pageData.form.ContactNO ,readOnly:readonly" class="z-txt easyui-validatebox" data-options="required:true,validType:['contactNO']" />
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">电子邮箱：</div>
    <div class="grid_9 val">
        <input type="text" data-bind="value:pageData.form.Email ,readOnly:readonly" class="z-txt easyui-validatebox" data-options="validType:['email']" />
    </div>
    <div class="clear"></div>
    <div class="grid_3 lbl">
        问题分类：
    </div>
    <div class="grid_9 val" data-bind="inputwidth:0.4">
        <input id="MsgRootClass" type="text" class="z-txt easyui-combobox" data-bind="comboboxReadOnly: readonly" />
        <input id="MsgClass" data-options="required:true" type="text" class="z-txt easyui-combobox" data-bind="comboboxReadOnly: readonly" />
    </div>
    <div class="clear"></div>
    <div class="username">用户帐号：<input type="text" class="z-txt" data-bind="value:user.usercode,readOnly: readonly" /><br />
        <span>普通用户可不填。注册用户请登录，注册用户可以获得个人管理中心。</span></div>
    <div>用户密码：<input type="password" class="z-txt" data-bind="value:user.password,readOnly: readonly" /></div>
    <div>
        <input type="submit" class="sbt" value="" data-bind="click:readonly()?null:submitClick,enable:!readonly()" style="cursor: pointer" />
    </div>
</div>
<script type="text/javascript" src="~/Content/js/utils/setAddress.js"></script>
<script>
    var setMsgClass = function (bindValue, valueField) {
        $.ajaxSettings.async = false;
        var rootClass = $('#MsgRootClass').combobox({
            url: '/api/msg/msgclass/GetValueTextListRoot',
            method: "Get",
            queryParams: { IsEnable: '1' },
            editable: false,
            onSelect: function (record) {
                $.get('/api/msg/msgclass/GetValueTextListByPid/' + record.value,{IsEnable:'1'}, function (data) {
                    msgClass.combobox("clear").combobox('loadData', data);
                }, 'json');
                getValue();
            }
        });

        var msgClass = $('#MsgClass').combobox({
            editable: false,
            onSelect: function (record) {
                getValue();
            }
        });

        var getValue = function () {
            var selvalue = msgClass.combobox("getValue");
            viewModel.pageData.form.MsgClass(selvalue);
        }
    }
</script>
